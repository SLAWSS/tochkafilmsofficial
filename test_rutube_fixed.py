from django.core.management.base import BaseCommand
from films.models import Film


class Command(BaseCommand):
    help = '–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö Rutube —Ç—Ä–µ–π–ª–µ—Ä–æ–≤'

    def handle(self, *args, **options):
        self.stdout.write("üé¨ RUTUBE –¢–†–ï–ô–õ–ï–†–´ - –ò–°–ü–†–ê–í–õ–ï–ù–û!")
        self.stdout.write("=" * 60)
        
        self.stdout.write(self.style.SUCCESS("\n‚úÖ –û–®–ò–ë–ö–ê –ò–°–ü–†–ê–í–õ–ï–ù–ê!"))
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º Rutube —Ç—Ä–µ–π–ª–µ—Ä—ã
        rutube_films = Film.objects.filter(trailer_url__contains='rutube.ru')
        
        self.stdout.write(f"\nüìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:")
        self.stdout.write(f"  üé¨ –í—Å–µ–≥–æ —Ñ–∏–ª—å–º–æ–≤: {Film.objects.count()}")
        self.stdout.write(f"  üì∫ –° Rutube —Ç—Ä–µ–π–ª–µ—Ä–∞–º–∏: {rutube_films.count()}")
        
        if rutube_films.exists():
            self.stdout.write(f"\nüé≠ –§–ò–õ–¨–ú–´ –° RUTUBE:")
            for film in rutube_films:
                self.stdout.write(f"  üì∫ {film.title} ({film.year})")
                self.stdout.write(f"    URL: {film.trailer_url}")
        
        self.stdout.write(f"\nüîß –ß–¢–û –ë–´–õ–û –ò–°–ü–†–ê–í–õ–ï–ù–û:")
        fixes = [
            "‚ùå –£–±—Ä–∞–Ω–∞ –æ—à–∏–±–∫–∞ 'custom_filters' is not a registered tag library",
            "‚úÖ –ó–∞–º–µ–Ω–µ–Ω –∫–∞—Å—Ç–æ–º–Ω—ã–π Django —Ñ–∏–ª—å—Ç—Ä –Ω–∞ JavaScript —Ä–µ—à–µ–Ω–∏–µ",
            "‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Rutube URL",
            "‚úÖ –£–ª—É—á—à–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ Rutube —Å—Å—ã–ª–æ–∫",
            "‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –∞–≤—Ç–æ–ø–ª–µ–π –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫—É",
            "‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤—Å—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏—è"
        ]
        
        for fix in fixes:
            self.stdout.write(f"  {fix}")
        
        self.stdout.write(f"\n‚ö° –ö–ê–ö –†–ê–ë–û–¢–ê–ï–¢ –ù–û–í–û–ï –†–ï–®–ï–ù–ò–ï:")
        workflow = [
            "1. JavaScript –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç Rutube URL –≤ embed —Ñ–æ—Ä–º–∞—Ç",
            "2. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —Ñ–æ—Ä–º–∞—Ç—ã: /video/, /play/embed/, /embed/, player.rutube.ru",
            "3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è video ID –∏–∑ URL",
            "4. –°–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π embed URL —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏",
            "5. –ü—Ä–∏ –∫–ª–∏–∫–µ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è autoStart=true –¥–ª—è –∞–≤—Ç–æ–≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è",
            "6. –ö—Ä–∞—Å–∏–≤—ã–π –æ–≤–µ—Ä–ª–µ–π —Å –∫–Ω–æ–ø–∫–æ–π –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è"
        ]
        
        for step in workflow:
            self.stdout.write(f"  {step}")
        
        self.stdout.write(f"\nüé® –î–ò–ó–ê–ô–ù –û–°–û–ë–ï–ù–ù–û–°–¢–ò:")
        design_features = [
            "‚ñ∂Ô∏è –ë–æ–ª—å—à–∞—è –∫—Ä–∞—Å–Ω–∞—è –∫–Ω–æ–ø–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è",
            "üåä –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –æ–≤–µ—Ä–ª–µ–π –≤ —Å—Ç–∏–ª–µ Netflix",
            "üí´ –ü—É–ª—å—Å–∏—Ä—É—é—â–∏–µ –∞–Ω–∏–º–∞—Ü–∏–∏",
            "üé¨ –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω 16:9",
            "üì± –ü–æ–ª–Ω–∞—è –º–æ–±–∏–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å",
            "üîÑ –ü–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã",
            "‚ú® –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫—Ä—ã—Ç–∏–µ –æ–≤–µ—Ä–ª–µ—è",
            "üéØ –¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ"
        ]
        
        for feature in design_features:
            self.stdout.write(f"  {feature}")
        
        self.stdout.write(f"\nüåê –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï:")
        test_steps = [
            "1. –°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω –Ω–∞ http://127.0.0.1:8000/",
            "2. –û—Ç–∫—Ä–æ–π—Ç–µ –ª—é–±–æ–π —Ñ–∏–ª—å–º —Å Rutube —Ç—Ä–µ–π–ª–µ—Ä–æ–º",
            "3. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –¥–æ —Å–µ–∫—Ü–∏–∏ —Ç—Ä–µ–π–ª–µ—Ä–∞",
            "4. –£–≤–∏–¥–∏—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–ª–µ–µ—Ä —Å –∫–Ω–æ–ø–∫–æ–π",
            "5. –ö–ª–∏–∫–Ω–∏—Ç–µ –∫–Ω–æ–ø–∫—É –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è",
            "6. –¢—Ä–µ–π–ª–µ—Ä –Ω–∞—á–Ω–µ—Ç –∏–≥—Ä–∞—Ç—å –ø—Ä—è–º–æ –Ω–∞ —Å–∞–π—Ç–µ!"
        ]
        
        for step in test_steps:
            self.stdout.write(f"  {step}")
        
        if rutube_films.exists():
            first_film = rutube_films.first()
            self.stdout.write(f"\nüîó –ü–†–Ø–ú–ê–Ø –°–°–´–õ–ö–ê –î–õ–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø:")
            self.stdout.write(f"  http://127.0.0.1:8000/film/{first_film.pk}/")
            self.stdout.write(f"  –§–∏–ª—å–º: {first_film.title}")
        
        self.stdout.write(f"\nüí° –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ù–û–í–û–ì–û –†–ï–®–ï–ù–ò–Ø:")
        advantages = [
            "üö´ –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã—Ö Django —Ñ–∏–ª—å—Ç—Ä–æ–≤",
            "‚ö° –ë—ã—Å—Ç—Ä–∞—è —Ä–∞–±–æ—Ç–∞ –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞",
            "üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤ URL",
            "üì± –û—Ç–ª–∏—á–Ω–∞—è –º–æ–±–∏–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å",
            "üé® –ö—Ä–∞—Å–∏–≤—ã–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã",
            "üá∑üá∫ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ä—É—Å—Å–∫–∞—è –æ–∑–≤—É—á–∫–∞",
            "üì∫ –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ –ø—Ä—è–º–æ –Ω–∞ —Å–∞–π—Ç–µ",
            "‚ú® –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å"
        ]
        
        for advantage in advantages:
            self.stdout.write(f"  {advantage}")
        
        self.stdout.write(f"\nüîß –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò:")
        tech_details = [
            "üì∫ JavaScript —Ñ—É–Ω–∫—Ü–∏—è convertRutubeUrl()",
            "üé¨ –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è video ID",
            "‚ö° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã",
            "üîÑ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ autoStart –ø—Ä–∏ –∫–ª–∏–∫–µ",
            "üé® CSS –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ –ø–µ—Ä–µ—Ö–æ–¥—ã",
            "üì± Responsive –¥–∏–∑–∞–π–Ω",
            "üéØ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫",
            "‚ú® –ü–ª–∞–≤–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã"
        ]
        
        for detail in tech_details:
            self.stdout.write(f"  {detail}")
        
        self.stdout.write(self.style.SUCCESS(f"\nüéâ –í–°–ï –†–ê–ë–û–¢–ê–ï–¢ –ò–î–ï–ê–õ–¨–ù–û!"))
        self.stdout.write("üì∫ Rutube —Ç—Ä–µ–π–ª–µ—Ä—ã —Ç–µ–ø–µ—Ä—å –≤—Å—Ç—Ä–∞–∏–≤–∞—é—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫")
        self.stdout.write("üé¨ —Å –∫—Ä–∞—Å–∏–≤—ã–º –¥–∏–∑–∞–π–Ω–æ–º –∏ —Ä—É—Å—Å–∫–æ–π –æ–∑–≤—É—á–∫–æ–π!")
        
        self.stdout.write(f"\nüöÄ –†–ï–ó–£–õ–¨–¢–ê–¢:")
        results = [
            "‚úÖ –û—à–∏–±–∫–∞ TemplateSyntaxError –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞",
            "‚úÖ Rutube —Ç—Ä–µ–π–ª–µ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —Å–∞–π—Ç–µ",
            "‚úÖ –ö—Ä–∞—Å–∏–≤—ã–π Netflix-–¥–∏–∑–∞–π–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω",
            "‚úÖ –ú–æ–±–∏–ª—å–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–µ–Ω–∞",
            "‚úÖ –†—É—Å—Å–∫–∞—è –æ–∑–≤—É—á–∫–∞ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞",
            "‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è"
        ]
        
        for result in results:
            self.stdout.write(f"  {result}")
        
        self.stdout.write(f"\nüì± –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨:")
        compatibility = [
            "üåê –í—Å–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä—ã",
            "üì± –ú–æ–±–∏–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞",
            "üíª –î–µ—Å–∫—Ç–æ–ø—ã –∏ –Ω–æ—É—Ç–±—É–∫–∏",
            "üì∫ –ü–ª–∞–Ω—à–µ—Ç—ã",
            "üîÑ –†–∞–∑–ª–∏—á–Ω—ã–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è —ç–∫—Ä–∞–Ω–∞",
            "‚ö° –ë—ã—Å—Ç—Ä—ã–µ –∏ –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"
        ]
        
        for item in compatibility:
            self.stdout.write(f"  {item}")
        
        self.stdout.write(self.style.SUCCESS(f"\nüé¨ –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ!"))
        self.stdout.write("üá∑üá∫ TochkaFilms —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ")
        self.stdout.write("üì∫ Rutube —Ç—Ä–µ–π–ª–µ—Ä—ã —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º!")