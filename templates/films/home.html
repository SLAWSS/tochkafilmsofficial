{% extends 'films/base.html' %}
{% load static %}

{% block title %}–ì–ª–∞–≤–Ω–∞—è - TochkaFilms{% endblock %}

{% block content %}
<section class="hero parallax morphing-bg">
    <div class="container">
        <h1 class="cinematic-title bounce-in">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ TochkaFilms</h1>
        <p class="subtitle slide-in-right float">–°–º–æ—Ç—Ä–∏—Ç–µ –ª—É—á—à–∏–µ —Ñ–∏–ª—å–º—ã –æ–Ω–ª–∞–π–Ω —Å —Ä—É—Å—Å–∫–æ–π –æ–∑–≤—É—á–∫–æ–π üá∑üá∫</p>
        <div class="quote elegant-text scale-in">
            "–ö–∏–Ω–æ ‚Äî —ç—Ç–æ –ø—Ä–∞–≤–¥–∞ –¥–≤–∞–¥—Ü–∞—Ç—å —á–µ—Ç—ã—Ä–µ —Ä–∞–∑–∞ –≤ —Å–µ–∫—É–Ω–¥—É" ‚Äî –ñ–∞–Ω-–õ—é–∫ –ì–æ–¥–∞—Ä
        </div>
    </div>
</section>

{% if featured_films %}
<section class="featured reveal">
    <div class="container">
        <h2 class="gradient-text-gold text-glow">üé¨ –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ</h2>
        <div class="film-grid">
            {% for film in featured_films %}
            <div class="film-card ripple scale-in glow">
                {% if film.is_featured %}
                    <div class="featured-badge pulse">‚≠ê –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º</div>
                {% endif %}
                {% if film.trailer_url %}
                    {% if 'vk.com' in film.trailer_url %}
                        <div class="russian-badge vk-badge">VK</div>
                    {% elif 'rutube.ru' in film.trailer_url %}
                        <div class="russian-badge rutube-badge">RuTube</div>
                    {% endif %}
                {% endif %}
                <a href="{% url 'films:film_detail' film.pk %}">
                    {% if film.poster %}
                        <img src="{{ film.poster.url }}" alt="{{ film.title }}">
                        {% if film.trailer_url %}
                            <div class="play-overlay"></div>
                        {% endif %}
                    {% else %}
                        <div class="no-poster">{{ film.title }}</div>
                    {% endif %}
                    <div class="film-info">
                        <h3>{{ film.title }}</h3>
                        <p>{{ film.year }} | <span class="rating-stars">‚≠ê {{ film.rating }}</span></p>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<section class="recent reveal">
    <div class="container">
        <h2 class="gradient-text-blue slide-in-left">üÜï –ù–µ–¥–∞–≤–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ</h2>
        <div class="film-grid">
            {% for film in recent_films %}
            <div class="film-card">
                {% if film.trailer_url %}
                    {% if 'vk.com' in film.trailer_url %}
                        <div class="russian-badge vk-badge">VK</div>
                    {% elif 'rutube.ru' in film.trailer_url %}
                        <div class="russian-badge rutube-badge">RuTube</div>
                    {% endif %}
                {% endif %}
                <a href="{% url 'films:film_detail' film.pk %}">
                    {% if film.poster %}
                        <img src="{{ film.poster.url }}" alt="{{ film.title }}">
                        {% if film.trailer_url %}
                            <div class="play-overlay"></div>
                        {% endif %}
                    {% else %}
                        <div class="no-poster">{{ film.title }}</div>
                    {% endif %}
                    <div class="film-info">
                        <h3>{{ film.title }}</h3>
                        <p>{{ film.year }} | <span class="rating-stars">‚≠ê {{ film.rating }}</span></p>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

{% if user.is_authenticated and recommended_films %}
<section class="recommended-section reveal">
    <div class="container">
        <h2 class="gradient-text-red glow">üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≤–∞—Å</h2>
        <div class="film-grid">
            {% for film in recommended_films %}
            <div class="film-card">
                {% if film.trailer_url %}
                    {% if 'vk.com' in film.trailer_url %}
                        <div class="russian-badge vk-badge">VK</div>
                    {% elif 'rutube.ru' in film.trailer_url %}
                        <div class="russian-badge rutube-badge">RuTube</div>
                    {% endif %}
                {% endif %}
                <a href="{% url 'films:film_detail' film.pk %}">
                    {% if film.poster %}
                        <img src="{{ film.poster.url }}" alt="{{ film.title }}">
                        {% if film.trailer_url %}
                            <div class="play-overlay"></div>
                        {% endif %}
                    {% else %}
                        <div class="no-poster">{{ film.title }}</div>
                    {% endif %}
                    <div class="film-info">
                        <h3>{{ film.title }}</h3>
                        <p>{{ film.year }} | <span class="rating-stars">‚≠ê {{ film.rating }}</span></p>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

{% if user.is_authenticated and recent_viewed %}
<section class="recent-viewed reveal">
    <div class="container">
        <h2 class="gradient-text-gold neon-text">üì∫ –ù–µ–¥–∞–≤–Ω–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã–µ</h2>
        <div class="film-grid">
            {% for view in recent_viewed %}
            <div class="film-card">
                {% if view.film.trailer_url %}
                    {% if 'vk.com' in view.film.trailer_url %}
                        <div class="russian-badge vk-badge">VK</div>
                    {% elif 'rutube.ru' in view.film.trailer_url %}
                        <div class="russian-badge rutube-badge">RuTube</div>
                    {% endif %}
                {% endif %}
                <a href="{% url 'films:film_detail' view.film.pk %}">
                    {% if view.film.poster %}
                        <img src="{{ view.film.poster.url }}" alt="{{ view.film.title }}">
                        {% if view.film.trailer_url %}
                            <div class="play-overlay"></div>
                        {% endif %}
                    {% else %}
                        <div class="no-poster">{{ view.film.title }}</div>
                    {% endif %}
                    <div class="film-info">
                        <h3>{{ view.film.title }}</h3>
                        <p>{{ view.film.year }} | <span class="rating-stars">‚≠ê {{ view.film.rating }}</span></p>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% endif %}

<section class="categories reveal">
    <div class="container">
        <h2 class="gradient-text-blue text-shadow-strong">üé≠ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
        <div class="category-list">
            {% for category in categories %}
                <a href="{% url 'films:category_films' category.slug %}" class="category-tag">
                    <img src="{% static 'images/' %}{{ category.slug }}-icon.png" alt="{{ category.name }}" class="category-icon">
                    {{ category.name }}
                </a>
            {% endfor %}
        </div>
    </div>
</section>
{% endblock %}