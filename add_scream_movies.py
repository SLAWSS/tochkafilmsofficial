from django.core.management.base import BaseCommand
from films.models import Category, Film


class Command(BaseCommand):
    help = '–î–æ–±–∞–≤–ª—è–µ—Ç —Ñ—Ä–∞–Ω—à–∏–∑—É "–ö—Ä–∏–∫" (–≤—Å–µ 6 —á–∞—Å—Ç–µ–π)'

    def handle(self, *args, **kwargs):
        # –ü–æ–ª—É—á–∞–µ–º –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–£–∂–∞—Å—ã"
        horror_category, _ = Category.objects.get_or_create(
            name="–£–∂–∞—Å—ã", 
            defaults={"slug": "horror"}
        )
        
        thriller_category, _ = Category.objects.get_or_create(
            name="–¢—Ä–∏–ª–ª–µ—Ä", 
            defaults={"slug": "thriller"}
        )

        # –î–∞–Ω–Ω—ã–µ –æ —Ñ–∏–ª—å–º–∞—Ö "–ö—Ä–∏–∫"
        scream_movies = [
            {
                'title': '–ö—Ä–∏–∫',
                'description': '–°–µ—Ä–∏–π–Ω—ã–π —É–±–∏–π—Ü–∞ –≤ –º–∞—Å–∫–µ –ø—Ä–∏–∑—Ä–∞–∫–∞ —Ç–µ—Ä—Ä–æ—Ä–∏–∑–∏—Ä—É–µ—Ç –ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤ –≤ –º–∞–ª–µ–Ω—å–∫–æ–º –≥–æ—Ä–æ–¥–∫–µ –í—É–¥—Å–±–æ—Ä–æ. –°–∏–¥–Ω–∏ –ü—Ä–µ—Å–∫–æ—Ç—Ç –∏ –µ—ë –¥—Ä—É–∑—å—è —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –º–∏—à–µ–Ω—è–º–∏ –∑–∞–≥–∞–¥–æ—á–Ω–æ–≥–æ –º–∞–Ω—å—è–∫–∞.',
                'year': 1996,
                'duration': 111,
                'rating': 7.4,
                'is_featured': True,
            },
            {
                'title': '–ö—Ä–∏–∫ 2',
                'description': '–°–∏–¥–Ω–∏ –ü—Ä–µ—Å–∫–æ—Ç—Ç –ø—ã—Ç–∞–µ—Ç—Å—è –Ω–∞—á–∞—Ç—å –Ω–æ–≤—É—é –∂–∏–∑–Ω—å –≤ –∫–æ–ª–ª–µ–¥–∂–µ, –Ω–æ —É–±–∏–π—Ü–∞ –≤ –º–∞—Å–∫–µ –ø—Ä–∏–∑—Ä–∞–∫–∞ —Å–Ω–æ–≤–∞ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, —á—Ç–æ–±—ã –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å –∫—Ä–æ–≤–∞–≤—É—é –æ—Ö–æ—Ç—É.',
                'year': 1997,
                'duration': 120,
                'rating': 6.3,
                'is_featured': False,
            },
            {
                'title': '–ö—Ä–∏–∫ 3',
                'description': '–°–∏–¥–Ω–∏ —Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ—Ç –æ–±—â–µ—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, –Ω–æ –Ω–æ–≤—ã–µ —É–±–∏–π—Å—Ç–≤–∞ –∑–∞—Å—Ç–∞–≤–ª—è—é—Ç –µ—ë –≤–µ—Ä–Ω—É—Ç—å—Å—è, —á—Ç–æ–±—ã –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ—á–µ—Ä–µ–¥–Ω–æ–≥–æ —É–±–∏–π—Ü—É –≤ –º–∞—Å–∫–µ –ø—Ä–∏–∑—Ä–∞–∫–∞.',
                'year': 2000,
                'duration': 116,
                'rating': 5.6,
                'is_featured': False,
            },
            {
                'title': '–ö—Ä–∏–∫ 4',
                'description': '–°–ø—É—Å—Ç—è –¥–µ—Å—è—Ç—å –ª–µ—Ç –°–∏–¥–Ω–∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –í—É–¥—Å–±–æ—Ä–æ, –≥–¥–µ —Å–Ω–æ–≤–∞ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —É–±–∏–π—Å—Ç–≤–∞. –ù–æ–≤–æ–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ —Å—Ç–æ–ª–∫–Ω—É—Ç—å—Å—è —Å –ø—Ä–∏–∑—Ä–∞–∫–æ–º –ø—Ä–æ—à–ª–æ–≥–æ.',
                'year': 2011,
                'duration': 111,
                'rating': 6.2,
                'is_featured': False,
            },
            {
                'title': '–ö—Ä–∏–∫ 5',
                'description': '–î–≤–∞–¥—Ü–∞—Ç—å –ø—è—Ç—å –ª–µ—Ç —Å–ø—É—Å—Ç—è –Ω–æ–≤—ã–π —É–±–∏–π—Ü–∞ –Ω–∞–¥–µ–≤–∞–µ—Ç –º–∞—Å–∫—É –ü—Ä–∏–∑—Ä–∞—á–Ω–æ–≥–æ –ª–∏—Ü–∞ –∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø—Ä–µ—Å–ª–µ–¥–æ–≤–∞—Ç—å –≥—Ä—É–ø–ø—É –ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤, —á—Ç–æ–±—ã —Ä–∞—Å–∫—Ä—ã—Ç—å —Å–µ–∫—Ä–µ—Ç—ã —Å–º–µ—Ä—Ç–æ–Ω–æ—Å–Ω–æ–≥–æ –ø—Ä–æ—à–ª–æ–≥–æ –≥–æ—Ä–æ–¥–∞.',
                'year': 2022,
                'duration': 114,
                'rating': 6.3,
                'is_featured': True,
            },
            {
                'title': '–ö—Ä–∏–∫ 6',
                'description': '–°–µ—Å—Ç—Ä—ã –ö–∞—Ä–ø–µ–Ω—Ç–µ—Ä –ø–æ–∫–∏–¥–∞—é—Ç –í—É–¥—Å–±–æ—Ä–æ, –Ω–æ –Ω–µ –º–æ–≥—É—Ç –∏–∑–±–µ–∂–∞—Ç—å —Å–≤–æ–µ–≥–æ –ø—Ä–æ—à–ª–æ–≥–æ. –í –ù—å—é-–ô–æ—Ä–∫–µ –∏—Ö —Å–Ω–æ–≤–∞ –ø—Ä–µ—Å–ª–µ–¥—É–µ—Ç —É–±–∏–π—Ü–∞ –≤ –º–∞—Å–∫–µ –ü—Ä–∏–∑—Ä–∞—á–Ω–æ–≥–æ –ª–∏—Ü–∞.',
                'year': 2023,
                'duration': 122,
                'rating': 6.5,
                'is_featured': True,
            },
        ]

        created_count = 0
        for movie_data in scream_movies:
            film, created = Film.objects.get_or_create(
                title=movie_data['title'],
                defaults=movie_data
            )
            
            if created:
                # –î–æ–±–∞–≤–ª—è–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                film.categories.add(horror_category, thriller_category)
                created_count += 1
                self.stdout.write(f'‚úì –î–æ–±–∞–≤–ª–µ–Ω —Ñ–∏–ª—å–º: {film.title} ({film.year})')
            else:
                self.stdout.write(f'‚ö† –§–∏–ª—å–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: {film.title}')

        if created_count > 0:
            self.stdout.write(
                self.style.SUCCESS(f'\nüé¨ –î–æ–±–∞–≤–ª–µ–Ω–æ {created_count} —Ñ–∏–ª—å–º–æ–≤ —Ñ—Ä–∞–Ω—à–∏–∑—ã "–ö—Ä–∏–∫"!')
            )
            self.stdout.write('–¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ—Å—Ç–µ—Ä—ã: python manage.py create_all_posters')
        else:
            self.stdout.write(
                self.style.WARNING('–í—Å–µ —Ñ–∏–ª—å–º—ã "–ö—Ä–∏–∫" —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö')
            )